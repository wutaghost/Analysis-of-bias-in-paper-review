# å¿«é€Ÿå…¥é—¨æŒ‡å—

æ¬¢è¿ä½¿ç”¨è®ºæ–‡å®¡ç¨¿åå·®åˆ†æç³»ç»Ÿï¼æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨5åˆ†é’Ÿå†…å¼€å§‹ä½¿ç”¨ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3æ­¥ï¼‰

### æ­¥éª¤1: å®‰è£…ä¾èµ–
```bash
cd bias
pip install -r requirements.txt
```

### æ­¥éª¤2: é…ç½®APIå¯†é’¥
```bash
# åˆ›å»º.envæ–‡ä»¶å¹¶æ·»åŠ æ‚¨çš„APIå¯†é’¥
echo "OPENAI_API_KEY=sk-your-api-key-here" > .env
```

### æ­¥éª¤3: è¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆä»…2ç¯‡è®ºæ–‡ï¼‰
```bash
python quick_test.py
```

å¦‚æœçœ‹åˆ° `âœ… å¿«é€Ÿæµ‹è¯•å®Œæˆï¼`ï¼Œè¯´æ˜ç³»ç»Ÿæ­£å¸¸å·¥ä½œï¼

---

## ğŸ“Š å››æ­¥éª¤åˆ†ææµç¨‹

æœ¬ç³»ç»Ÿé‡‡ç”¨å››æ­¥éª¤æµç¨‹è¿›è¡Œåå·®åˆ†æï¼š

```
æ­¥éª¤1: ç‰¹å¾æå–     â”€â”€[LLM]â”€â”€â†’  æå–æ¯ä¸ªå®¡ç¨¿äººçš„ä¼˜ç¼ºç‚¹
                                  â†“
æ­¥éª¤2: åŒ¿ååŒ–å¤„ç†   â”€â”€[ä»£ç ]â”€â”€â†’  å»é™¤å®¡ç¨¿äººä¿¡æ¯ï¼Œæ‰“ä¹±é¡ºåº
                                  â†“
æ­¥éª¤3: æƒé‡é‡åŒ–     â”€â”€[LLM]â”€â”€â†’  åŸºäºè®ºæ–‡å…¨æ–‡é‡åŒ–æƒé‡
                                  â†“
æ­¥éª¤4: åŒ¹é…è®¡ç®—     â”€â”€[ä»£ç ]â”€â”€â†’  åŒ¹é…å›å®¡ç¨¿äººï¼Œçº¿æ€§ç›¸åŠ 
```

**å…³é”®ç‰¹ç‚¹**ï¼šæ­¥éª¤2å’Œæ­¥éª¤4ä½¿ç”¨ä»£ç é€»è¾‘ï¼Œä¸è°ƒç”¨LLMï¼Œç¡®ä¿å®¢è§‚å…¬æ­£ã€‚

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰

### æµ‹è¯•è„šæœ¬
```bash
python quick_test.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- è‡ªåŠ¨åŠ è½½ ICLR_2025_CLEAN ç›®å½•çš„æ•°æ®
- **ä»…å¤„ç†å‰2ç¯‡è®ºæ–‡**ï¼ˆèŠ‚çœæ—¶é—´å’Œè´¹ç”¨ï¼‰
- è¿è¡Œå®Œæ•´çš„å››æ­¥éª¤åˆ†æ
- æ˜¾ç¤ºè¯¦ç»†çš„åˆ†æç»“æœ

### é¢„æœŸè¾“å‡º
```
ğŸ§ª å¿«é€Ÿæµ‹è¯•è„šæœ¬ - ä»…åˆ†æ2ç¯‡è®ºæ–‡
======================================================================
ğŸ“‚ æ•°æ®ç›®å½•: ../ICLR_2025_CLEAN
âœ“ é…ç½®éªŒè¯æˆåŠŸ

ğŸ“ æµ‹è¯•è®ºæ–‡:
   1. Paper Title 1...
      å®¡ç¨¿äººæ•°: 3
   2. Paper Title 2...
      å®¡ç¨¿äººæ•°: 4

ğŸš€ å¼€å§‹å››æ­¥éª¤åˆ†æ...
...
âœ… å¿«é€Ÿæµ‹è¯•å®Œæˆï¼
```

---

## ğŸ“ˆ å®Œæ•´åˆ†æICLRæ•°æ®

### æ–¹å¼1: ä½¿ç”¨ä¸“ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
python run_iclr_analysis.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- è‡ªåŠ¨åŠ è½½ICLR_2025_CLEANç›®å½•çš„æ•°æ®
- è¯¢é—®æ˜¯å¦åªå¤„ç†éƒ¨åˆ†æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰
- è¿è¡Œå®Œæ•´çš„å››æ­¥éª¤åå·®åˆ†æ
- ç”Ÿæˆæ‰€æœ‰å¯è§†åŒ–å›¾è¡¨
- ä¿å­˜è¯¦ç»†æŠ¥å‘Š

### æ–¹å¼2: ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
```bash
# å®Œæ•´åˆ†æ
python main.py --input ../ICLR_2025_CLEAN --format openreview_json

# æŒ‡å®šè¾“å‡ºç›®å½•
python main.py --input ../ICLR_2025_CLEAN --format openreview_json --output results/my_analysis
```

### æ–¹å¼3: ä½¿ç”¨Python API
```python
from pipeline import ReviewBiasAnalysisPipeline

# åˆå§‹åŒ–
pipeline = ReviewBiasAnalysisPipeline()

# åŠ è½½ICLRæ•°æ®
pipeline.load_from_openreview("../ICLR_2025_CLEAN")

# é™åˆ¶æµ‹è¯•æ•°é‡ï¼ˆå¯é€‰ï¼‰
pipeline.papers = pipeline.papers[:10]

# è¿è¡Œå®Œæ•´å››æ­¥éª¤åˆ†æ
results = pipeline.run_full_analysis()

# æˆ–åˆ†æ­¥æ‰§è¡Œ
pipeline.step1_extract_features()       # LLMæå–ä¼˜ç¼ºç‚¹
pipeline.step2_anonymize_and_shuffle()  # ä»£ç å¤„ç†åŒ¿ååŒ–
pipeline.step3_quantify_weights()       # LLMé‡åŒ–æƒé‡
pipeline.step4_match_and_calculate()    # ä»£ç è®¡ç®—åˆ†æ•°

# åç»­åˆ†æ
pipeline.analyze_bias()
pipeline.generate_visualizations()

# ä¿å­˜ç»“æœ
pipeline.save_results()
pipeline.generate_report()
```

---

## ğŸ“ æŸ¥çœ‹ç»“æœ

åˆ†æå®Œæˆåï¼ŒæŸ¥çœ‹ `results/` ç›®å½•ï¼š

```bash
# æŸ¥çœ‹ç›®å½•ç»“æ„
ls -la results/

# æŸ¥çœ‹ä¸­é—´æ–‡ä»¶
ls results/extraction/        # æ­¥éª¤1è¾“å‡º
ls results/anonymized/        # æ­¥éª¤2è¾“å‡º
ls results/quantified/        # æ­¥éª¤3è¾“å‡º

# æŸ¥çœ‹æ¯ç¯‡è®ºæ–‡çš„è¯¦ç»†æŠ¥å‘Š
ls results/paper_details/

# æŸ¥çœ‹æ–‡æœ¬æŠ¥å‘Š
cat results/analysis_report.txt

# æŸ¥çœ‹å›¾è¡¨
ls results/figures/
```

### è¾“å‡ºæ–‡ä»¶è¯´æ˜

| ç›®å½•/æ–‡ä»¶ | è¯´æ˜ |
|-----------|------|
| `extraction/extraction_results.json` | æ­¥éª¤1: æ¯ä¸ªå®¡ç¨¿äººçš„ä¼˜ç¼ºç‚¹ï¼ˆå«å®¡ç¨¿äººIDï¼‰ |
| `anonymized/anonymized_pros_cons.json` | æ­¥éª¤2: åŒ¿ååŒ–åçš„ä¼˜ç¼ºç‚¹ï¼ˆæ— å®¡ç¨¿äººä¿¡æ¯ï¼‰ |
| `anonymized/original_mapping.json` | æ­¥éª¤2: æ˜ å°„å…³ç³»ï¼ˆç”¨äºæ­¥éª¤4åŒ¹é…ï¼‰ |
| `quantified/quantified_weights.json` | æ­¥éª¤3: é‡åŒ–åçš„æƒé‡ |
| `paper_details/*.md` | æ¯ç¯‡è®ºæ–‡çš„è¯¦ç»†åˆ†ææŠ¥å‘Š |
| `analysis_results.json` | å®Œæ•´åˆ†æç»“æœ |
| `analysis_report.txt` | æ–‡æœ¬æ ¼å¼æŠ¥å‘Š |

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. ç‰¹å¾æå–ï¼ˆæ­¥éª¤1ï¼‰
ç³»ç»Ÿä½¿ç”¨LLMä»å®¡ç¨¿æ–‡æœ¬ä¸­è‡ªåŠ¨æå–ï¼š
- ä¼˜ç‚¹åˆ—è¡¨ï¼ˆåŒ…å«æè¿°å’Œç±»åˆ«ï¼‰
- ç¼ºç‚¹åˆ—è¡¨ï¼ˆåŒ…å«æè¿°å’Œç±»åˆ«ï¼‰

### 2. åŒ¿ååŒ–å¤„ç†ï¼ˆæ­¥éª¤2ï¼‰
**ä»£ç é€»è¾‘å¤„ç†**ï¼Œä¸ä½¿ç”¨LLMï¼š
- å»é™¤å®¡ç¨¿äººä¿¡æ¯
- éšæœºæ‰“ä¹±ä¼˜ç¼ºç‚¹é¡ºåº
- ä¿ç•™æ˜ å°„å…³ç³»ç”¨äºåç»­åŒ¹é…

### 3. æƒé‡é‡åŒ–ï¼ˆæ­¥éª¤3ï¼‰
ä¸ºæ¯ä¸ªä¼˜ç¼ºç‚¹èµ‹äºˆé‡åŒ–æƒé‡ï¼š
- ä¼˜ç‚¹ï¼šæ­£æƒé‡ï¼ˆ+0.1 åˆ° +2.0ï¼‰
- ç¼ºç‚¹ï¼šè´Ÿæƒé‡ï¼ˆ-0.1 åˆ° -2.0ï¼‰
- åŸºäºè®ºæ–‡å…¨æ–‡å†…å®¹è¿›è¡Œè¯„ä¼°

### 4. åŒ¹é…è®¡ç®—ï¼ˆæ­¥éª¤4ï¼‰
**ä»£ç é€»è¾‘å¤„ç†**ï¼Œä¸ä½¿ç”¨LLMï¼š
- æ ¹æ®æ˜ å°„æ–‡ä»¶åŒ¹é…å›å®¡ç¨¿äºº
- çº¿æ€§ç›¸åŠ è®¡ç®—æœŸæœ›åˆ†æ•°

### 5. åå·®åˆ†æ
```
åå·® = å®é™…åˆ†æ•° - æœŸæœ›åˆ†æ•°
```
- æ­£åå·®ï¼šå®¡ç¨¿äººç»™åˆ†åé«˜
- è´Ÿåå·®ï¼šå®¡ç¨¿äººç»™åˆ†åä½
- é›¶åå·®ï¼šç»™åˆ†åˆç†

---

## ğŸ”§ å¸¸è§åœºæ™¯

### åœºæ™¯1: å¿«é€ŸéªŒè¯ç³»ç»Ÿæ˜¯å¦æ­£å¸¸
```bash
python quick_test.py
```

### åœºæ™¯2: åªæƒ³æµ‹è¯•å°‘é‡è®ºæ–‡
```python
from pipeline import ReviewBiasAnalysisPipeline

pipeline = ReviewBiasAnalysisPipeline()
pipeline.load_from_openreview('../ICLR_2025_CLEAN')
pipeline.papers = pipeline.papers[:5]  # é™åˆ¶ä¸º5ç¯‡
pipeline.run_full_analysis()
```

### åœºæ™¯3: æŸ¥çœ‹å•ç¯‡è®ºæ–‡çš„è¯¦ç»†åˆ†æ
```bash
cat results/paper_details/{paper_id}_details.md
```

### åœºæ™¯4: å¯¼å‡ºåˆ°Excelè¿›è¡Œè¿›ä¸€æ­¥åˆ†æ
```python
import pandas as pd
from pipeline import ReviewBiasAnalysisPipeline

pipeline = ReviewBiasAnalysisPipeline()
pipeline.load_from_openreview("../ICLR_2025_CLEAN")
pipeline.papers = pipeline.papers[:10]
pipeline.run_full_analysis()

# åˆ›å»ºDataFrame
data = []
for paper in pipeline.papers:
    for review in paper.reviews:
        data.append({
            'è®ºæ–‡': paper.title,
            'å®¡ç¨¿äºº': review.reviewer_id,
            'å®é™…åˆ†æ•°': review.actual_score,
            'æœŸæœ›åˆ†æ•°': review.expected_score,
            'åå·®': review.bias,
            'ä¼˜ç‚¹æ•°': len(review.pros_weights),
            'ç¼ºç‚¹æ•°': len(review.cons_weights),
        })

df = pd.DataFrame(data)
df.to_excel('results/analysis.xlsx', index=False)
print("å·²å¯¼å‡ºåˆ° results/analysis.xlsx")
```

---

## âš ï¸ é‡è¦æç¤º

### å…³äºAPIè´¹ç”¨
- æœ¬ç³»ç»Ÿä¼šè°ƒç”¨OpenAI APIï¼Œä¼šäº§ç”Ÿè´¹ç”¨
- ä½¿ç”¨ `gpt-4o-mini` æ¨¡å‹æˆæœ¬è¾ƒä½ï¼ˆé»˜è®¤ï¼‰
- ç³»ç»Ÿè‡ªåŠ¨å¯ç”¨ç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨
- **å»ºè®®å…ˆç”¨ `quick_test.py` æµ‹è¯•ï¼ˆä»…2ç¯‡è®ºæ–‡ï¼‰**

### å…³äºå¤„ç†æ—¶é—´
| æ•°æ®é‡ | é¢„è®¡æ—¶é—´ |
|--------|----------|
| 2ç¯‡è®ºæ–‡ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰ | 2-5åˆ†é’Ÿ |
| 10ç¯‡è®ºæ–‡ | 10-20åˆ†é’Ÿ |
| 100ç¯‡è®ºæ–‡ | 60-120åˆ†é’Ÿ |

### å…³äºæ•°æ®éšç§
- æ‰€æœ‰æ•°æ®åœ¨æœ¬åœ°å¤„ç†
- LLMè°ƒç”¨é€šè¿‡OpenAI API
- æ³¨æ„ä¸è¦ä¸Šä¼ æ•æ„Ÿæ•°æ®

---

## ğŸ› é‡åˆ°é—®é¢˜ï¼Ÿ

### é—®é¢˜1: ImportError: No module named 'xxx'
```bash
pip install -r requirements.txt
```

### é—®é¢˜2: APIè°ƒç”¨å¤±è´¥
- æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹é”™è¯¯æ—¥å¿—

### é—®é¢˜3: æ‰¾ä¸åˆ°æ•°æ®ç›®å½•
```bash
# ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•ä¸‹è¿è¡Œ
cd bias
ls ../ICLR_2025_CLEAN  # åº”è¯¥èƒ½çœ‹åˆ°è®ºæ–‡æ–‡ä»¶å¤¹
```

### é—®é¢˜4: å†…å­˜ä¸è¶³
- å‡å°‘å¤„ç†çš„è®ºæ–‡æ•°é‡: `pipeline.papers = pipeline.papers[:10]`
- åˆ†æ‰¹å¤„ç†æ•°æ®

---

## ğŸ’¡ æŠ€å·§å’Œå»ºè®®

1. **é¦–æ¬¡ä½¿ç”¨**: è¿è¡Œ `quick_test.py` æµ‹è¯•2ç¯‡è®ºæ–‡
2. **èŠ‚çœè´¹ç”¨**: ç¡®ä¿ç¼“å­˜å¯ç”¨ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
3. **åŠ é€Ÿåˆ†æ**: ç¬¬äºŒæ¬¡è¿è¡Œç›¸åŒæ•°æ®ä¼šå¾ˆå¿«ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
4. **ç›‘æ§è¿›åº¦**: ç³»ç»Ÿä¼šå®æ—¶æ˜¾ç¤ºè¿›åº¦
5. **æŸ¥çœ‹ä¸­é—´ç»“æœ**: æ£€æŸ¥ `results/extraction/` ç­‰ç›®å½•

---

## ğŸ“ è·å–å¸®åŠ©

```bash
# æŸ¥çœ‹å‘½ä»¤è¡Œå¸®åŠ©
python main.py --help

# è¿è¡Œå¿«é€Ÿæµ‹è¯•
python quick_test.py

# æŸ¥çœ‹ç¤ºä¾‹
python example_usage.py
```

---

## ğŸ“ ç†è§£ç»“æœ

### å…³é”®æŒ‡æ ‡è§£é‡Š

1. **å¹³å‡åå·®**: 
   - æ¥è¿‘0ï¼šå®¡ç¨¿äººç»™åˆ†è¾ƒä¸ºåˆç†
   - æ˜¾è‘—åç¦»0ï¼šå­˜åœ¨ç³»ç»Ÿæ€§åå·®

2. **åå·®æ ‡å‡†å·®**:
   - è¶Šå¤§ï¼šä¸åŒå®¡ç¨¿äººä¹‹é—´å·®å¼‚è¶Šå¤§
   - è¶Šå°ï¼šå®¡ç¨¿ç›¸å¯¹ä¸€è‡´

3. **Pearsonç›¸å…³ç³»æ•°**:
   - æ¥è¿‘1ï¼šæœŸæœ›åˆ†æ•°ä¸å®é™…åˆ†æ•°é«˜åº¦æ­£ç›¸å…³
   - æ¥è¿‘0ï¼šä¸¤è€…å…³ç³»ä¸å¤§

---

## ä¸‹ä¸€æ­¥

- âœ… è¿è¡Œ `python quick_test.py` å¿«é€Ÿæµ‹è¯•ï¼ˆ2ç¯‡è®ºæ–‡ï¼‰
- âœ… è¿è¡Œ `python run_iclr_analysis.py` åˆ†æICLRæ•°æ®
- âœ… æŸ¥çœ‹ `results/` ç›®å½•ä¸­çš„ç»“æœ
- âœ… é˜…è¯» `results/paper_details/` ä¸­çš„è¯¦ç»†æŠ¥å‘Š
- âœ… æ ¹æ®éœ€è¦è°ƒæ•´åˆ†æå‚æ•°

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰
